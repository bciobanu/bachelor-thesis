\chapter{Context}

\section{Concepte din algebra liniara}

\begin{defn}
  Un \textbf{monoid} $G = (A, \circ)$ este o structura algebrica formata dintr-o
  multime $A$ si o lege de compozitie asociativa si cu element neutru.
\end{defn}

\begin{defn}
  Un \textbf{grup} $G = (A, \circ)$ este o structura algebrica formata dintr-o
  multime $A$ si o lege de compozitie care respecta urmatoarele proprietati:
  \begin{itemize}
      \item{$\forall\ x_{1}, x_{2} \in G, x_{1} \circ x_{2} \in G$.}
      \item{$\forall\ x_{1}, x_{2}, x_{3} \in G, (x_{1} \circ x_{2}) \circ x_{3} = x_{1} \circ (x_{2} \circ x_{3})$.}
      \item{$\exists\ e \in G \text{ astfel
      incat } \forall\ x \in G\ e \circ x = x \circ e = x$.}
      \item{$\forall\ x_{1} \in G\ \exists\ x_{2} \in G \ x_{1} \circ x_{2} = x_{2} \circ x_{1} = e$.}
  \end{itemize}
  In plus, acesta este abelian daca
  $\forall\ x_{1}, x_{2} \in G\ x_{1} \circ x_{2} = x_{2} \circ x_{1}$.
\end{defn}

\begin{defn}
  Un \textbf{inel} $I = (A, +, *)$ este o structura algebrica formata dintr-o
  multime $A$ si doua operatii binare definite pe $A \times A$ cu valori tot in
  $A$, care respecta urmatoarele proprietati:
  \begin{itemize}
      \item{$(A, +)$ este un grup abelian.}
      \item{$(A, *)$ este un monoid.}
      \item{Distributivitatea lui $*$ fata de $+$.}
  \end{itemize}
\end{defn}

\begin{defn}
  Un \textbf{polinom} este o expresie construita dintr-una sau mai multe
  variabile si constante, folosind doar operatii de adunare, scadere, inmultire
  si ridicare la putere constanta pozitiva intreaga.
\end{defn}

\begin{defn}
  O \textbf{matrice} este un tabel dreptunghiular de elemente ale unui inel.
\end{defn}

\subsection{Interpolare Lagrange}

\textbf{Polinomul de interpolare Lagrange} este un polinom $P$ construit in asa
fel incat avand $k + 1$ perechi
$(x_{1}, y_{1}), (x_{2}, y_{2}), \ldots, (x_{k+1}, y_{k+1})$ avem ca
$P(x_{i}) = y_{i}\ \forall\ 1 \leq i \leq K + 1$. \par
Constructia lui $P$ a fost oferita de Joseph Louis Lagrange in $1795$:
\begin{equation}
  P(x) := \sum_{i_{1}=0}^{k} y_{i_{1}} * \prod_{1 \leq i_{2} \leq k + 1 \ \land \ i_{1} \neq i_{2}} \frac{x - x_{i_{2}}}{x_{i_{1}} - x_{i_{2}}}
\end{equation}

\section{Teoria grafurilor}

\begin{defn}
  Un \textbf{graf neorientat} este o pereche ordonata $G(V, E)$, unde:
  \begin{itemize}
    \item{$V$ este multimea de noduri}.
    \item{$E \subseteq \{(x, y)\ |\ (x, y) \in V^2 \land x \neq y\}$ este
      multimea de muchii, care sunt perechi neordonate de noduri}.
  \end{itemize}
\end{defn}

\begin{defn}
  Un \textbf{graf bipartit} este un graf neorientat $G(V, E)$ ale carui noduri pot fi
  partitionate in doua multimi disjuncte $V_{1}$ si $V_{2}$, altfel incat fiecare muchie
  conecteaza un nod din multimea $V_{1}$ cu un nod din multimea $V_{2}$. Atunci,
  se va nota cu $G(V_{1}, V_{2}, E)$.
\end{defn}

\begin{defn}
  Un \textbf{cuplaj} intr-un graf este o multime de muchii fara noduri in comun.
\end{defn}

\begin{defn}
  \textbf{Matricea Edmonds} $A$ a grafului bipartit $G(U, V, E)$, unde
  $U = \{u_{1}, u_{2}, u_{3}, \ldots, u_{n}\}$,
  $V = \{v_{1}, v_{2}, v_{3}, \ldots, v_{n}\}$ si $x_{i,j}$ indeterminate, se defineste ca:
   \begin{equation}
    A=
    \begin{cases}
      x_{i,j} & \text{daca}\ (u_{i}, v_{j}) \in E \\
      0 & \text{altfel}
    \end{cases}
  \end{equation}
\end{defn}

\begin{thm}
  \label{edmonds}
  Un graf bipartit $G(U, V, E)$ admite cuplaj perfect daca si numai daca
  polinomul determinantului matricei sale Edmonds nu este polinomul nul.
\end{thm}

\begin{clr}
  Numarul de cuplaje perfecte este egal cu numarul monoamelor in polinomul $det(A_{i,j})$.
\end{clr}

\begin{clr}
  Rangul matricei Edmonds este egal marimea cuplajului maximal.
\end{clr}

\pagebreak

\section{Lema Schwartzâ€“Zippel}
\textbf{Lema Schwartz-Zippel} este o metoda utila pentru a verifica intr-un mod
probabilistic daca un polinom in mai multe variabile este polinomul nul.
% TODO: poate discutie despre autori?

\begin{thm}
  Fie $P \in F \lbrack x_{1}, x_{2}, \ldots, x_{n} \rbrack$ un polinom nenul de grad $d \geq 0$
  peste corpul $F$ si $S$ o submultime finita a lui $F$. Alegem
  $r_{1}, r_{2}, \ldots, r_{n}$ uniform aleator si independent din $S$. Atunci:
  \begin{equation}
    \Pr \lbrack P(r_{1}, r_{2}, \ldots, r_{n}) = 0 \rbrack \leq \frac{d}{|S|}
  \end{equation}
\end{thm}

Acest rezultat are sens odata ce ne gandim pe cazul de baza, cand $n=1$ deoarece
un polinom de grad $d$ are cel mult $d$ radacini. Intreaga demonstratie se
bazeaza pe inductie matematica si se poate consulta in \cite{schwartzzippel}.

\begin{thm}
  Lema Schwartz-Zippel se poate folosi in \ref{edmonds} pentru a verifica
  existenta unui cuplaj perfect in timp polinomial.
\end{thm}

Fie $A$ \textbf{matricea Edmonds} asociata grafului. $\det(A)$ este un polinom
in $n^{2}$ variabile, de grad $n$. Alegem corpul pe care lucram ca fiind
$\mathbb{F}_{p}$. Determinantul poate fi calculat sub $\mathbb{F}_{p}$ in timp $O(n^{3})$
folosind Eliminare Gaussiana. Chiar mai mult decat atat, acest calcul
poate fi facut in timp $O(\log^{2} n)$ daca avem la dispozitie $O(n^{3.5})$
procesoare \cite{paralleldet}. Probabilitatea de esec a algoritmului este de $\frac{n}{p}$.

\pagebreak

\section{Lema de izolare}
\textbf{Lema de izolare} este o metoda de a reduce numarul de solutii ale unei
probleme la una singura, daca aceasta exista. Aceasta se obtine prin adaugarea
unor constrangeri aleatoare in asa fel incat, cu o probabilitate neglijabila,
va exista o singura solutie care satisface constragerile aditionale.

Lema a fost introdusa de Valiant si Vazirani in lucrarea ``NP is as easy as
detecting unique solutions'', publicata in 1986.

\begin{thm}
  \label{isolation}
  Fie $n$ si $m$ doua numere intregi pozitive si $F$ o familie de submultimi a
  lui $\{1, 2, \ldots n\}$. Fie
  $w : \{1, 2, \ldots, n\} \to \{1, 2, \ldots, m\}$ o functie care asociaza
  valori uniform aleatoare si independente din codomeniu. Atunci, cu o
  probabilitate de cel putin $1 - \frac{n}{m}$, va exista o singura multime $S$ in
  $F$ pentru care $\sum_{x\in S}{w(x)}$ este minima.
\end{thm}

\pagebreak

\section{Algoritm paralelizabil pentru cuplaj}

In ``Matching is as easy as matrix inversion'' \cite{matchingezmatrix} se
descrie o metoda pentru a cauta cuplajul perfect folosind acest rezultat.
Consideram $G(U, V, E)$ un graf bipartit. Asociem fiecarei muchii din $E$ un
cost uniform din multimea $\{1, 2, \ldots, 2|E|\}$. Conform \ref{isolation}, cu
probabilitate de cel putin $\frac{1}{2}$ va exista un cuplaj unic de cost minim.
Consideram $U = \{u_{1}, u_{2}, u_{3}, \ldots, u_{n}\}$,
$V = \{v_{1}, v_{2}, v_{3}, \ldots, v_{n}\}$ si costul aleator ales mai devreme muchiei
$(u_{i}, v_{j})$ ca fiind $w_{i,j}$. Fie $A$ matricea Edmonds a acestui
graf, construita in felul urmator:
\begin{equation}
A=
\begin{cases}
  2^{w_{i,j}} & \text{daca}\ (u_{i}, v_{j}) \in E \\
  0 & \text{altfel}
\end{cases}
\end{equation}

Definim costul unui cuplaj ca fiind suma costurilor muchiilor alese in acea multime.
\begin{lem}
  Daca $p$ este costul cuplajului minim si acesta este si unic, atunci $\det(A) \neq 0$, iar
  $2^{p} \ |\ \det(A)$ si $2^{p+1} \not| \ \det(A)$.
\end{lem}

Fie $\text{sgn} : S_{n} \to \{\pm 1\}$, $\text{sgn}(P)$ este $+1$ daca $P$
este permutare para, altfel $-1$. $\text{sgn}(P)$ se numeste signatura
permutarii $P$.

\begin{equation}
  \label{isolationdet}
  \det(A) = \sum_{P \in S_{n}} (\text{sgn}(P) \prod_{1 \leq i \leq N} A_{i, P_{i}})
\end{equation}

Pentru fiecare cuplaj din $G$ putem asocia unic o permutare $P$ din $S_{n}$:
daca muchia $(u_{i}, v_{j})$ este aleasa in cuplaj, atunci $P_{i} \equiv j$.
Pentru o permutare care nu are asociat un cuplaj perfect, aceasta nu va
contribui deloc la valoarea expresiei \ref{isolationdet}. \par

Daca $P$ este permutarea asociata cuplajului de cost minim, atunci
$\prod_{1 \leq i \leq N} A_{i, P_{i}} = 2^{p}$. Valoarea celorlalte permutari
este fie $0$, fie o putere de $2$ mai mare decat $2^{p}$ (deoarece $P$ este
unica). Asadar, valoarea determinatului o sa fie divizibila cu $2^{p}$ si
mai mult, aceasta va fi cel mai mare divizor de aceasta forma.

\pagebreak

Pentru a determina multimea muchiilor din cuplaj, trebuie sa mai notam cateva observatii.

\begin{lem}
  Fie $A'$ matricea obtinuta eliminand linia $i$ si coloana $j$. Fie
  $C \def \det(A') \cdot \frac{2^{w_{i,j}}}$. Muchia
  $(u_{i}, v_{j})$ face parte din cuplaj daca si numai daca $2^{p} \ | \ C$,
  $2^{p+1} \not| \ C$ si $C \neq 0$.
\end{lem}

In primul rand, valoarea $\det(A') \cdot 2^{w_{i,j}}$ este chiar valoarea
determinantului calculat dupa formula de la \ref{isolationdet}, cu precizarea ca
se vor consider doar permutarile $P$ cu $P_{i} = j$. Acest lucru se datoreaza
faptului ca permutarile alese in calculul lui $\det(A')$ vor avea cu un element
mai putin decat cele din $\det(A)$, iar pentru elementul lipsa inmultim mereu cu
valorea asociata muchiei $(u_{i}, v_{j})$, adica $2^{w_{i,j}}$.
Aplicand apoi observatiile demonstratiei pentru \ref{isolationdet} obtinem
rezultatul dorit si in cele din urma, un algoritm pentru determinarea cuplajului
perfect care nu se bazeaza pe retele de flux, ci doar pe obiect de algebra
liniara: \par

\vspace{5 mm}

\begin{algorithm}[H]
 \label{cuplajizolare}
 \KwData{Graf bipartit G(U, V, E) care admite cuplaj perfect}
 \KwResult{Multimea muchiilor alese intr-un posibil cuplaj perfect}
 \Begin{
  determina w\;
  construieste A\;
  $p \longleftarrow \det(A)$\;
  $C \longleftarrow \{\}$\;
  \For{$(u_{i}, v_{j}) \in E$}{
    determina $A'$\;
    \If{$\frac{\det(A') \cdot 2^{w_{i,j}}}{2^{p}} \mod 2 = 1$}{
      $C \longleftarrow C \cup \{(u_{i}, v_{j})\}$\;
    }
  }
  \Return{$C$}\;
 }
 \caption{Cuplaj perfect lema de izolare}
\end{algorithm}

\pagebreak

In continuare vom presupune ca putem efectua operatiile aritmetice de baza in timp $O(1)$.
Atunci algoritmul \ref{cuplajizolare} dureaza $O(n^{5})$, daca folosim
algoritmul lui Gauss pentru calcularea determinantului. Putem sa nu recalculam
valoarea determinantului la fiecare iteratie folosind:
\begin{equation}
  \det(A + uv^{T}) = (1 + v^{T} A^{-1} u) \det(A)
\end{equation}

Cu aceasta proprietatea a determinantului, cunoscuta si ca \textbf{Matrix
  determinant lemma} putem reduce complexitatea la $O(n^{4})$. In plus,
algoritmul se poate paraleliza bine, deoarece determinantul unei matrice
de marime $n \times n$ se poate calcula in timp $O(\log^{2}n)$ pe $O(n^{3.5})$ procesoare.

Unicitatea solutiei, garantata de \textbf{lema de izolare} permite procesoarelor
sa execute si pasul urmator, in care se testeaza o muchie daca face parte din
cuplaj, in paralel, deoarece se indreapta catre aceeasi solutie, cu o
certitudine destul de mare. Asadar si aceasta parte a algoritmului poate fi
calculata in timp polilogaritmic, daca avem la dispozitie un numar polinomial de
procesoare.

Deja se comporta mai prost decat algoritmii clasici de flux si inca nu am adus in discutie costul de
a lucra cu numere intregi de ordinul $O(4^{n^{4}})$, adica numere intregi cu
$2 * n^{4}$ biti. Avem nevoie de operatia de inmultire pe aceste numere, iar
aceasta nu se poate executa mai bine de $O(n^{4}\log n)$, rezultat recent
obtinut de algoritmul Harvey-Hoeven in 2019.
De asemenea, in ipoteza curenta algoritmul nu este determinist si
are probabilitate de succes de $\frac{1}{2}$, deci trebuie rulat de mai multe
ori pentru a gasi un rezultat de certitudine mare.

\pagebreak

\section{Cuplaj rosu-albastru}

Sa consideram un graf bipartit $G(U, V, E)$, unde $E_{1}$ este multimea
muchiilor rosii, $E_{2}$ este multimea muchiilor albastre, iar
$E = E_{1} \cup E_{2}$. Dorim sa alfam daca exista un cuplaj perfect
in care se folosesc exact $k$ muchii rosii, stiind ca daca acesta exista, este
si unic. \par

Aceasta problema nu se poate rezolva cu algoritmi de flux maxim, spre deosebire
de celelalte probleme de pana acum. Totusi, avem sanse sa o rezolvam, daca
procedam prin a modifica \textbf{matricea Edmonds} cat sa avem un mod de a ne da seama de
culoarea muchiilor alese in cuplaj:

\begin{equation}
  A=
  \begin{cases}
    y & \text{daca}\ (u_{i}, v_{j}) \in E_{1} \\
    1 & \text{daca}\ (u_{i}, v_{j}) \in E_{2} \\
    0 & \text{altfel}
  \end{cases}
\end{equation}

$\det(A)$ va fi un polinom in $y$ de grad $n$. $G$ va avea un cuplaj perfect cu
$k$ muchii rosii daca coeficientul lui $y^{k}$ va fi nenul. Pentru a determina
acest numar putem sa interpolam polinomul $\det(A)$ folosind interpolarea
Lagrange. Tot ce ramane de facut este sa evaluam polinomul in $n+1$ puncte.

... discuta 2 abordari cand nu e unic, cu lema de izolare si cu schartz-zippel
