\chapter{Probleme}

\subsection{Divisible Matching}

\begin{tabular}{l@{\extracolsep{1cm}}l}
  Autor: & Konstantin Khadaev\\
  Concurs: & CS Academy Round \#67\\
  Limita de timp: & 4\ s\\
  Limita de memorie: & 256\ MB\\
\end{tabular}

\hspace{1cm}

\noindent \textbf{Enunt.} Se da un graf bipartit $G(U \cup V, E)$ cu $1 \leq |U| = |V| \leq 100$,
un numar intreg $2 \leq K \leq 100$ si o functie pentru a determina valoarea unei muchii
$f : E \to \{0, 1, \ldots, K-1\}$. Sa se determine daca exista un cuplaj perfect $M$,
astfel incat $K \ | \ \sum_{e \in M} f(e)$.

\hspace{1cm}

\noindent \textbf{Solutie.} Fara a pierde din generalitate, presupunem ca $|U| = |V| = N$.
O solutie evidenta in complexitate $O(N!)$ construieste si verifica toate permutarile din $S_{N}$.
Chiar daca le procesam in ordine aleatoare, numarul asteptat de pasi este tot de ordinul $N!$. \\
Urmatoarea solutie pe care o putem aborda este sa optimizam solutia de backtracking mentionata anterior
cu metoda programarii dinamice. Construim tabela $D_{i,\text{rem}, S}$ ca fiind o valoare booleana daca poti
cupla nodurile $\{u_{1}, u_{2}, \ldots, u_{i}\}$ din $U$ cu nodurile $S \subseteq V$ astfel incat restul sumei
valorilor muchiilor alese de pana acum, modulo $K$ este rem. Recurenta cu care se poate construi este:

\begin{multline*}
  D_{i,\text{rem}, S} = \\ D_{i-1, \text{rem} - f(e_{1}) \mod K, S - v_{1}} \text{ or }
                      D_{i-1, \text{rem} - f(e_{2}) \mod K, S - v_{2}} \text{ or }
                      \ldots \text{ or  } \\
                      D_{i-1, \text{rem} - f(e_{p}) \mod K, S - v_{P_{i}}}
                      \ \forall \ e_{j} = (u_{i}, v_{j}), 1 \leq j \leq P_{i}
\end{multline*}

\noindent Din pacate solutie ramane exponentiala, complexitatea acesteia fiind $O(KN^{2}2^{N})$.

\pagebreak

In ce urmeaza ne putem gandi sa rezolvam o subproblema mai simpla, mai exact cea in care $K=2$.
Ne intereseaza un cuplaj cu numar par de muchii de $1$. Daca privim muchiile cu $1$ ca fiind
rosii, iar celelalte ca fiind albastre, atunci obtinem problema \textbf{cuplajului rosu-albastru} (\ref{redbluematching}),
in care ne intereseaza doar ca numarul de muchii rosii sa fie par. In ce urmeaza ne vom concentra pe varianta
in care folosim lema Schwartz-Zippel. Avand \textbf{matricea Edmonds} $A$ construita special pentru acest caz,
$\det(A)$ este un polinom monic in variabila $y$. Atunci cand voiam sa aflam daca exista un cuplaj cu numar
fix de muchii rosii, interpolam $\det(A)$ si verificam daca $y^{k}$ are un coeficient nenul. In cazul de fata
ne intereseaza daca exista macar un termen $y^{k}$ cu coeficient nenul, iar $k$ par. O prima varianta este sa
interpolam polinomul pentru fiecare numar par, insa putem face mai eficient. O metoda sa aflam suma coeficientilor
pari ai unui polinom $p$ este sa evaluam $\frac{p(1) + p(-1)}{2}$. Desigur, in cazul nostru, acest calcul se
efectueaza tot intr-un corp finit si putem sa obtinem iar $0$ pentru ca s-au anulat coeficientii adunatii.
Din fericire, putem aplica iar lema Schwartz-Zippel sa obtinem ca acest fapt este, in continuare, indeajuns
de improbabil.

Pentru a continua sa rezolvam problema pentru orice $K$, amintim ca insumarea coeficientilor divizibil cu o anumita valoare
se poate face folosind \textbf{filtrarea prin radacini ale unitatii} (\ref{rootsofunityfilter}). Problema este insa
sa gasim un corp potrivit care are radacini ale unitatii de ordinul $K$. Daca nu gasim in timp util, mai putem sa extindem
corpul in asa fel incat sa introducem $\zeta \neq 1$ pentru care $\zeta^{K} = 1$. Insa, daca abordam asa, operatiile
aritmetice vor dura $O(K^{2})$ (sau macar $O(K \log K)$ daca folosim algoritmi de aritmetica "state of the art"),
in loc de $O(1)$, unde tinteam.
